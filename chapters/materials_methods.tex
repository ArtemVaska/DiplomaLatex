\newpage
\section{Материалы и методы}

\subsection{Первичный анализ}

В качестве отправной точки был произведен поиск гена \textit{Nxf1} внутри веб-сервиса NCBI~\cite{ncbi_general}.
Полученные данные были сохранены в текстовом формате и загружены в виде tsv-таблицы с помощью пакета pandas v2.2.3~\cite{pandas} для языка программирования Python v3.12.6~\cite{python_3_12}.
Всего был найден 651 вид, содержащий анализируемый ген, большинство из которых относятся к Deuterostomia (Вторичноротые) – 436 видов.
Таким образом, в качестве материалов выступали нуклеотидные и белковые последовательности, соответствующие гену \textit{Nxf1}, из открытых баз данных NCBI~\cite{ncbi_general}.

Большинство этапов последующего анализа реализовано в виде отдельных скриптов, разработанных в рамках данной работы, если не указано другое.
Для логического разделения на блоки был использован Jupyter Notebook v1.1.1~\cite{jupyter_notebook}.

По данным из полученной таблицы в порядке поискового эксперимента было построено филогенетическое дерево по найденным видам для оценки количества видов в таксонах более низкого ранга.
Для глубокого анализа было принято решение сфокусироваться на организмах, относящихся к группе Protostomia (Первичноротые), Cnidaria (Стрекающие), а также на всех группах из Deuterostomia за исключением Mammalia (Млекопитающие).

\subsection{Загрузка данных}

Для найденных организмов с помощью пакета NCBI E-utilities из BioPython v1.85~\cite{biopython} и NCBI Datasets Command-Line Interface (CLI) v18.0.2~\cite{datasets} были загружены нуклеотидные последовательности гена, кодирующих участков и мРНК, а также аминокислотные последовательности белка в формате FASTA и аннотации для гена в GenBank-формате, необходимые для получения нуклеотидных последовательностей экзонов и поиска ``консервативной кассеты``.
Затем были получены и проанализированы интересующие нас участки экзон-интрон-экзонной структуры и созданы файлы со всеми экзонами и ``кассетным`` интроном для всех организмов, у которых получилось найти ``кассету``.
Данные файлы будут необходимы для последующего анализа.

\subsection{Увеличение выборок}

Учитывая очень маленькие выборки во многих анализируемых группах (например, Cnidaria – 4 вида, Spiralia – 9 видов), было принято решение по увеличению их количества.
Для этой цели, учитывая разнообразия полученных генов даже внутри одной таксономической группы, самым эффективным вариантом оказалось использование PSI-BLAST~\cite{psi_blast}.
В качестве запроса (Query), или референса, использовались белковые последовательности тех организмов, у которых была найдена ``кассета``.
Для проведения PSI-BLAST были выбраны настройки по-умолчанию за исключением параметра Organism: поиск проводился внутри таксономической группы, к которой принадлежал референс, также референс был исключен из поиска.

\subsection{Парсинг результатов}

Парсинг результатов BLAST также осуществлялся с помощью пакета BioPython~\cite{biopython} и специально разработанных скриптов.
Он включал в себя фильтрацию данных по параметрам процента покрытия (Query Coverage, QC), длине и сходству (Per. Ident) найденных последовательностей (Subject), а также загрузку нуклеотидных и белковых последовательностей, однако реализация отличалась из-за особенностей баз данных NCBI~\cite{ncbi_general}.
Получение ``кассеты`` было произведено по тому же принципу, но, опять же, с отличиями.
Благодаря данному шагу удалось увеличить выборки суммарно на 117 видов.
К сожалению, для некоторых таксономических групп увеличение выборки оказалось невозможным в связи с отсутствием у некоторых организмов интересующего нас участка.

\subsection{Множественные выравнивания}

Множественные выравнивания осуществлялись с помощью алгоритма MAFFT~\cite{mafft}, 10 итераций, остальные настройки по-умолчанию, в программе Unipro UGENE v52.0~\cite{ugene}.

\subsection{Поиск консервативных мотивов внутри ``кассетного`` интрона}

Анализ видов из Deuterostomia изначально шел более благоприятно за счет большого сходства последовательностей, в том числе интронных, и большего количества видов в группах.
Для них также были загружены все необходимые файлы и произведен поиск и анализ ``консервативной кассеты``.
Мы решили сосредоточить свое внимание на организмах из Actinopterygii (Лучеперые рыбы), 72 вида, так как данных по ним ранее получено не было.

Учитывая большую степень сходства интронных последовательностей, с помощью пакета инструментов MEME Suite v5.5.8~\cite{meme} локально был произведен поиск консервативных мотивов внутри ``кассетного`` интрона.
Найденные мотивы, у которых E-value < 0.05 также локально были проанализированы с помощью Tomtom~\cite{tomtom} из того же пакета.
Для описанного шага была взята база данных JASPAR2024 CORE (NON-REDUNDANT) DNA.

\subsection{Построение и анализ вторичных структур РНК}

С помощью инструмента RNAfold v2.7.0 из пакета Vienna\-RNA~\cite{viennarna} были построены вторичные структуры РНК для нуклеотидных последовательностей в двух вариантах (MFE и Centroid), содержащих экзоны и ``кассетный`` интрон, так как мы предполагаем, что избегание интроном сплайсинга может быть опосредовано образованной им специфической вторичной структурой.
Учитывая данное предположение, разумным шагом также являлся анализ ``силы сайтов сплайсинга``, проведенный с помощью MaxEntScan~\cite{maxentsccan}.\\

Также с помощью скриптов цветом были выделены интронные последовательности внутри вторичной структуры и найденный мотив у Actinopterygii, который предположительно является CTE.

\subsection{Филогенетический анализ}

Для Actinopterygii также был проведен филогенетический анализ, включающий построение и визуализацию деревьев.
Для данной цели использовались самые популярные и проверенные временем инструменты.
Построение деревьев осуществлялось с помощью IQ-TREE v2.4.0~\cite{iqtree2}, визуализация – с помощью Figtree v1.4.4~\cite{figtree}.

\subsection{Настройки системы и доступность скриптов}

Работа проводилась в виртуальном окружении Mamba v1.5.5~\cite{mamba}, использованные пакеты и примеры анализа в Jupyter Notebooks можно найти в GitHub~\cite{github_general} репозитории автора: \url{https://github.com/ArtemVaska/Diploma}.

Для написания ВКР была использована система верстки LaTeX v4.76~\cite{latex}, таблицы генерировались в веб-сервисе TablesGenerator~\cite{tablesgenerator}.
Большинство рисунков обработано с помощью веб-сервиса draw.io~\cite{drawio}.
Построение графиков осуществлялось с помощью пакета для Python matplotlib v3.10.3~\cite{Hunter2007}.

Все шаги анализа проводились на базе операционной системы Linux Ubuntu 22.04~\cite{ubuntu}.
