\newpage
\section{Материалы и методы}

В качестве отправной точки был произведен поиск гена \textit{Nxf1} внутри веб-сервиса NCBI~\cite{ncbi_general}.
Полученные данные были сохранены в текстовом формате и загружены в качестве tsv-таблицы с помощью пакета pandas~\cite{pandas} для языка программирования Python (версия 3.12)~\cite{python_3_12}, всего был найден 651 ген для уникальных организмов, большинство из которых относятся к Deuterostomia (Вторичноротые).
Большинство этапов последующего анализа реализовано в виде отдельных скриптов, разработанных в рамках данной работы, если не указано другое.
Для логического разделения на блоки был использован Jupyter Notebook~\cite{jupyter_notebook}.

По данным из полученной таблицы в разведывательных целях было построено филогенетическое дерево исключительно для найденных генов.
Грубое распределение организмов по филогенетическим группам отображено на Изображении 1 (TODO).
Для глубокого анализа было принято решение сфокусироваться на организмах, относящихся к группе Protostomia (Первичноротые) за исключением Arthropoda (Членистоногие), которые были проанализированы в бакалаврской работе, а также на некоторых группах из Deuterostomia.

Для найденных организмов с помощью пакета NCBI E-utilities из BioPython~\cite{biopython} и NCBI Datasets Command-Line Interface (CLI)~\cite{datasets} были загружены нуклеотидные последовательности гена, кодирующих участков и мРНК, а также аминокислотные последовательности белка в формате FASTA и аннотации для гена в GenBank-формате, необходимые для получения нуклеотидных последовательностей экзонов и поиска ``консервативной кассеты``.
Затем были получены и проанализированы интересующие нас участки экзон-интрон-экзонной структуры и созданы файлы со всеми экзонами и ``кассетным`` интроном для всех организмов, у которых получилось найти ``кассету``.
Данные файлы будут необходимы для множественного выравнивания.

Учитывая очень маленькую выборку видов в каждой из анализируемых групп, было принято решение по увеличению их количества.
Для этой цели, учитывая разнообразия полученных генов даже внутри одной таксономической группы, самым эффективным вариантом оказалось использование PSI-BLAST~\cite{psi_blast}.
В качестве запроса (Query), или референса, использовались белковые последовательности тех организмов, у которых была найдена ``кассета``.
Для проведения PSI-BLAST были выбраны настройки по-умолчанию за исключением параметра Organism: поиск проводился внутри таксономической группы, к которой принадлежал референс, также референс был исключен из поиска.

Парсинг результатов BLAST также осуществлялся с помощью пакета BioPython~\cite{biopython} и специально разработанных скриптов.
Он также включал в себя фильтрацию данных по параметрам процента покрытия (Query Coverage, QC), длине и сходству (Per. Ident) найденных хитов у Subject, а также загрузку нуклеотидных и белковых последовательностей, однако реализация отличалась из-за особенностей баз данных NCBI~\cite{ncbi_general}.
Получение ``кассеты`` было произведено по тому же принципу, но, опять же, с отличиями.
Благодаря данному шагу удалось увеличить выборки суммарно на 128 видов, не включая референсные, хотя изначально их было всего 17.
К сожалению, для некоторых таксономических групп увеличение выборки оказалось невозможным технически в связи с отсутствием у некоторых организмов интересующего нас участка, т.к. непонятно, что в этом случае использовать в качестве референса.
Множественные выравнивания осуществлялись с помощью алгоритма MAFFT~\cite{mafft} в программе Unipro UGENE~\cite{ugene}.

Анализ видов из Deuterostomia изначально шел более благоприятно за счет большого сходства последовательностей, в том числе интронных, и большего количества видов в группах.
Для них также были загружены все необходимые файлы и произведен поиск и анализ ``консервативной кассеты``.
Учитывая большую степень сходства интронных последовательностей, с помощью пакета инструментов MEME Suite~\cite{meme} был произведен поиск консервативных мотивов внутри интрона.
Найденные мотивы, у которых E-value < 0.05 были проанализированы с помощью Tomtom~\cite{tomtom} из того же пакета.
Для описанного шага была взята база данных для позвоночных (TODO).
Попытка того же рода анализа была произведена и для Protostomia, однако не увенчалась успехом в связи с отсутствием базы данных мотивов для этой таксономической группы.

Помимо всего перечисленного, с помощью инструмента RNAfold из пакета Vienna\-RNA~\cite{viennarna} были построены вторичные структуры РНК для нуклеотидных последовательностей в двух вариантах (MFE и Centroid), содержащих экзоны и ``кассетный интрон``, т.к. мы предполагаем, что избегание интроном сплайсинга может быть опосредовано образованной им специфической вторичной структурой.
Также с помощью скриптов цветом были выделены интронные последовательности внутри вторичной структуры.
Учитывая данное предположение, разумным шагом также являлся анализ ``силы сайтов сплайсинга``, проведенный с помощью MaxEntScan~\cite{maxentsccan}.

Для некоторых групп организмов был проведен филогенетический анализ, включающий построение и визуализацию деревьев.
Для данной цели использовались самые популярные и проверенные временем инструменты по данным из научных статей (TODO).
Построение деревьев осуществлялось с помощью IQ-TREE 2~\cite{iqtree2}, визуализация - с помощью Figtree~\cite{figtree}.

Работа проводилась в виртуальном окружении Mamba~\cite{mamba}, использованные пакеты и примеры анализа в Jupyter Notebooks можно найти в GitHub~\cite{github_general} репозитории автора: \url{https://github.com/ArtemVaska/Diploma}.

Для написания ВКР была использована система верстки LaTeX~\cite{latex}.
